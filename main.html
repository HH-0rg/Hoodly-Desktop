<!Doctype html>
<html>
<head>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="styles/chatbox.css"> <!-- placeholder for the chatbox styling -->
	<link rel="stylesheet" href="styles/cards.css" /> <!-- stylesheet for the cards -->
	<link rel="stylesheet" href="styles/basic.css"> <!-- styles for the topnav,main area and chatbtn -->
	<script type="text/javascript" src="scripts/cards.js"></script> <!-- Lazy load for the community cards -->
	<title>Hoodly Desktop</title>
</head>
<body>
<!-- Top bar -->
<div id="topnav">
	<input type='text' id="search" placeholder="Look up a community">
	<button  style="margin-left: 67%;"><i class="fa fa-search"></i></button>
</div>
<!-- Everything except the topbar goes here -->
<div class="main">
	<div class = "comm" > <!-- also styled in cards.css -->
		<ul id="card-list">
		</ul>
	<br><br> <!-- Fixing a layout discrepancy -->	
	</div>
<div class="chatbtn"></div> <!-- Will later be used to pull out the chat box -->
<div id = "chatcontainer" ></div> 

<p id="debug"></p> <!-- for debugging purposes -->
</div>
<script> // might port to an external file later on.
	const electron = require('electron');
	const mysql = require('mysql');
	var connection = mysql.createConnection({
		host:"localhost", // Prototype is set up on a local server.Plan to move this online once I have the funds
		user: "root", 
		password: null, //Default username and password for the development session.Will change before it goes public
		database: "city"
	});
	const {ipcRenderer}=electron;
	function opencom(com){
		window.location='http://localhost:3000/communities/'+com+'/dashboard'; //TODO: redirect to the community page
	}
 	var cards= document.querySelector('#card-list');
 	$fetchcoms='SELECT * FROM `communities` where `city` = "roorkee"'; // SQL for all tables available in SQL.md
 	// Fetch and display communities from the database.
 	//TODO : Change this to Jquery
 	connection.query($fetchcoms,(err,rows,fields)=>{
 		for(i=0;i<rows.length;i++){
 			cards.innerHTML+="<li class='card' style='margin:0px;' onclick='opencom(`"+rows[i]['name']+"`)'><a class='card-image' href='#' style='background-image: url(coms/dispics/"+rows[i]['name']+".jpg)' data-image-full='coms/dispics/"+rows[i]['name']+".jpg'> <img src='coms/dispics/"+rows[i]['name']+".jpg' alt='Psychopomp' /> </a><a class='card-description' href='#'><h2 style='text-align:center;'>"+rows[i]['name']+"</h2><p style='text-align:center;'>"+rows[i]['name']+"</p></a></li>";
 		}

 	});
	
</script>
</body>
</html> 